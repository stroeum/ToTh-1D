clearvars
close all
clc

load('Meek1953_orig.mat')
d = 1.72; % _cm
pr.Crt.CO2.MC53{1}   = 10.^MC53_CO2_Fig_2_17(:,1)*d; % _cm_Torr, Crt
V_cr.Crt.CO2.MC53{1} = MC53_CO2_Fig_2_17(:,2)*1e3; % _V

R2_24 = [0.158 2.3]; % _cm
pr.cyl.CO2.MC53{1}   = MC53_CO2n_Fig_2_24(:,1)*R2_24(1); % _cm_Torr, Cyl
pr.cyl.CO2.MC53{2}   = MC53_CO2p_Fig_2_24(:,1)*R2_24(1); % _cm_Torr, Cyl
V_cr.cyl.CO2.MC53{1} = MC53_CO2n_Fig_2_24(:,2); % _V
V_cr.cyl.CO2.MC53{2} = MC53_CO2p_Fig_2_24(:,2); % _V

pr.Crt.CO2.MC53{2}    = MC53_CO2_01_Fig_7_5b(:,1)*760; % _cm_Torr, Crt
V_cr.Crt.CO2.MC53{2}  = MC53_CO2_01_Fig_7_5b(:,2)*1e3; % _V
pr.Crt.CO2.MC53{3}    = MC53_CO2_02_Fig_7_5b(:,1)*760; % _cm_Torr, Crt
V_cr.Crt.CO2.MC53{3}  = MC53_CO2_02_Fig_7_5b(:,2)*1e3; % _V
pr.Crt.CO2.MC53{4}    = MC53_CO2_03_Fig_7_5b(:,1)*760; % _cm_Torr, Crt
V_cr.Crt.CO2.MC53{4}  = MC53_CO2_03_Fig_7_5b(:,2)*1e3; % _V
pr.Crt.CO2.MC53{5}    = MC53_CO2_04_Fig_7_5b(:,1)*760; % _cm_Torr, Crt
V_cr.Crt.CO2.MC53{5}  = MC53_CO2_04_Fig_7_5b(:,2)*1e3; % _V
pr.Crt.CO2.MC53{6}    = MC53_CO2_05_Fig_7_5b(:,1)*760; % _cm_Torr, Crt
V_cr.Crt.CO2.MC53{6}  = MC53_CO2_05_Fig_7_5b(:,2)*1e3; % _V
pr.Crt.CO2.MC53{7}    = MC53_CO2_07_Fig_7_5b(:,1)*760; % _cm_Torr, Crt
V_cr.Crt.CO2.MC53{7}  = MC53_CO2_07_Fig_7_5b(:,2)*1e3; % _V
pr.Crt.CO2.MC53{8}    = MC53_CO2_10_Fig_7_5b(:,1)*760; % _cm_Torr, Crt
V_cr.Crt.CO2.MC53{8}  = MC53_CO2_10_Fig_7_5b(:,2)*1e3; % _V
pr.Crt.CO2.MC53{9}    = MC53_CO2_20_Fig_7_5b(:,1)*760; % _cm_Torr, Crt
V_cr.Crt.CO2.MC53{9}  = MC53_CO2_20_Fig_7_5b(:,2)*1e3; % _V

R7_18 = [...
    .935 90.0;...
    1.93 79.9;
    2.90 70.0;
    3.97 59.6
    ]*.1; % _cm

pr.cyl.CO2.MC53{3}   = MC53_CO2_900_Fig_7_18(:,1)*760*R7_18(1,1); % _cm_Torr, Cyl
V_cr.cyl.CO2.MC53{3} = MC53_CO2_900_Fig_7_18(:,2)*1e3; % _V
pr.cyl.CO2.MC53{4}   = MC53_CO2_799_Fig_7_18(:,1)*760*R7_18(2,1); % _cm_Torr, Cyl
V_cr.cyl.CO2.MC53{4} = MC53_CO2_799_Fig_7_18(:,2)*1e3; % _V
pr.cyl.CO2.MC53{5}   = MC53_CO2_700_Fig_7_18(:,1)*760*R7_18(3,1); % _cm_Torr, Cyl
V_cr.cyl.CO2.MC53{5} = MC53_CO2_700_Fig_7_18(:,2)*1e3; % _V
pr.cyl.CO2.MC53{6}   = MC53_CO2_596_Fig_7_18(:,1)*760*R7_18(4,1); % _cm_Torr, Cyl
V_cr.cyl.CO2.MC53{6} = MC53_CO2_596_Fig_7_18(:,2)*1e3; % _V


%% 
figure(1);
subplot(221)
semilogx(...
    pr.Crt.CO2.MC53{1}/d, V_cr.Crt.CO2.MC53{1}*1e-3, 'ko'...
    )
xlim([.01 .7])
ylim([0 24])
xlabel('p (Torr)')
ylabel('V (kV)')
title(['Fig 2.17 - Crt - ',num2str(d,'%4.2f'),' cm'])
set(gca,...
    'TickDir'   ,'out',...
    'XMinorTick','on' ,...
    'YMinorTick','on' ,...
    'XTick',[.02 .04 .06 .1 .2 .4 .6],...
    'YTick',0:4:24);
grid on
legend('CO_2','location','best')
legend boxoff

subplot(222)
plot(...
    pr.cyl.CO2.MC53{1}/R2_24(1), V_cr.cyl.CO2.MC53{1}, 'bo-',...
    pr.cyl.CO2.MC53{2}/R2_24(1), V_cr.cyl.CO2.MC53{2}, 'r+-' ...
    )
xlim([0 5])
ylim([300 1100])
xlabel('p (Torr)')
ylabel('V (V)')
title(['Fig 2.24 - Co-ax - ',num2str(R2_24(1),'%5.3f'),':',num2str(R2_24(2),'%3.1f'),' cm'])
set(gca,...
    'TickDir'   ,'out',...
    'XMinorTick','on' ,...
    'YMinorTick','on' ,...
    'XTick',0:.5:5,...
    'YTick',300:100:1100);
legend('cyl-','cyl+',...
    'location','best')
legend boxoff

subplot(223)
plot(...
    pr.Crt.CO2.MC53{2}/760, V_cr.Crt.CO2.MC53{2}*1e-3, 'o-',...
    pr.Crt.CO2.MC53{3}/760, V_cr.Crt.CO2.MC53{3}*1e-3, 'o-',...
    pr.Crt.CO2.MC53{4}/760, V_cr.Crt.CO2.MC53{4}*1e-3, 'o-',...
    pr.Crt.CO2.MC53{5}/760, V_cr.Crt.CO2.MC53{5}*1e-3, 'o-',...
    pr.Crt.CO2.MC53{6}/760, V_cr.Crt.CO2.MC53{6}*1e-3, 'o-',...
    pr.Crt.CO2.MC53{7}/760, V_cr.Crt.CO2.MC53{7}*1e-3, 'o-',...
    pr.Crt.CO2.MC53{8}/760, V_cr.Crt.CO2.MC53{8}*1e-3, 'o-',...
    pr.Crt.CO2.MC53{9}/760, V_cr.Crt.CO2.MC53{9}*1e-3, 'o-' ...
    )
xlabel('pR (cm.atm)')
ylabel('V (kV)')
title('Fig 7.5b - Crt')
set(gca,...
    'TickDir'   ,'out',...
    'XMinorTick','on' ,...
    'YMinorTick','on' ,...
    'XTick',0:2:20,...
    'YTick',0:50:1400);
legend('1 atm', '2 atm', '3 atm', '4 atm', '5 atm',...
    '7 atm', '10 atm', '20 atm',...
    'location','best')
legend boxoff

subplot(224)
plot(...
    pr.cyl.CO2.MC53{3}/760/R7_18(1,1), V_cr.cyl.CO2.MC53{3}*1e-3, 'o-',...
    pr.cyl.CO2.MC53{4}/760/R7_18(2,1), V_cr.cyl.CO2.MC53{4}*1e-3, 'o-',...
    pr.cyl.CO2.MC53{5}/760/R7_18(3,1), V_cr.cyl.CO2.MC53{5}*1e-3, 'o-',...
    pr.cyl.CO2.MC53{6}/760/R7_18(4,1), V_cr.cyl.CO2.MC53{6}*1e-3, 'o-')
xlim([0 20])
ylim([0 400])
xlabel('p (atm)')
ylabel('V (kV)')
title('Fig 7.18 - Co-ax')
set(gca,...
    'TickDir'   ,'out',...
    'XMinorTick','on' ,...
    'YMinorTick','on' ,...
    'XTick',0:2:20,...
    'YTick',0:50:1400);
legend(...
    [num2str(R7_18(1,1)*10,'%4.3f'),':',num2str(R7_18(1,2)*10,'%4.1f'),' mm'],...
    [num2str(R7_18(2,1)*10,'%4.2f'),':',num2str(R7_18(2,2)*10,'%4.1f'),' mm'],...
    [num2str(R7_18(3,1)*10,'%4.2f'),':',num2str(R7_18(3,2)*10,'%4.1f'),' mm'],...
    [num2str(R7_18(4,1)*10,'%4.2f'),':',num2str(R7_18(4,2)*10,'%4.1f'),' mm'],...
    'location','best')
legend boxoff
%% 
figure(2);
subplot(221)
semilogx(...
    pr.Crt.CO2.MC53{1}, V_cr.Crt.CO2.MC53{1}*1e-3, 'ko'...
    )
% xlim([.01 .7])
ylim([0 24])
xlabel('pd (cm.Torr)')
ylabel('V (kV)')
title(['Fig 2.17 Spark - Crt - ',num2str(d,'%4.2f'),' cm'])
set(gca,...
    'TickDir'   ,'out',...
    'XMinorTick','on' ,...
    'YMinorTick','on' ,...
    'XTick',[.02 .04 .06 .1 .2 .4 .6],...
    'YTick',0:4:24);
grid on
legend('CO_2','location','best')
legend boxoff

subplot(222)
plot(...
    pr.cyl.CO2.MC53{1}, V_cr.cyl.CO2.MC53{1}, 'bo-',...
    pr.cyl.CO2.MC53{2}, V_cr.cyl.CO2.MC53{2}, 'r+-' ...
    )
%xlim([0 5])
ylim([300 1100])
xlabel('pR_1 (cm.Torr)')
ylabel('V (V)')
title(['Fig 2.24 Corona - Co-ax - ',num2str(R2_24(1),'%5.3f'),':',num2str(R2_24(2),'%3.1f'),' cm'])
set(gca,...
    'TickDir'   ,'out',...
    'XMinorTick','on' ,...
    'YMinorTick','on' ,...
    'XTick',0:.1:5,...
    'YTick',300:100:1100);
legend('CO_2,cyl-','CO_2,cyl+',...
    'location','best')
legend boxoff

subplot(223)
plot(...
    pr.Crt.CO2.MC53{2}, V_cr.Crt.CO2.MC53{2}*1e-3, 'o-',...
    pr.Crt.CO2.MC53{3}, V_cr.Crt.CO2.MC53{3}*1e-3, 'o-',...
    pr.Crt.CO2.MC53{4}, V_cr.Crt.CO2.MC53{4}*1e-3, 'o-',...
    pr.Crt.CO2.MC53{5}, V_cr.Crt.CO2.MC53{5}*1e-3, 'o-',...
    pr.Crt.CO2.MC53{6}, V_cr.Crt.CO2.MC53{6}*1e-3, 'o-',...
    pr.Crt.CO2.MC53{7}, V_cr.Crt.CO2.MC53{7}*1e-3, 'o-',...
    pr.Crt.CO2.MC53{8}, V_cr.Crt.CO2.MC53{8}*1e-3, 'o-',...
    pr.Crt.CO2.MC53{9}, V_cr.Crt.CO2.MC53{9}*1e-3, 'o-' ...
    )
xlabel('pR (cm.Torr)')
ylabel('V (kV)')
title('Fig 7.5b - Crt')
set(gca,...
    'TickDir'   ,'out',...
    'XMinorTick','on' ,...
    'YMinorTick','on' ,...
    'YTick',0:50:1400);
legend('1 atm', '2 atm', '3 atm', '4 atm', '5 atm',...
    '7 atm', '10 atm', '20 atm',...
    'location','best')
legend boxoff

subplot(224)
plot(...
    pr.cyl.CO2.MC53{3}, V_cr.cyl.CO2.MC53{3}*1e-3, 'o-',...
    pr.cyl.CO2.MC53{4}, V_cr.cyl.CO2.MC53{4}*1e-3, 'o-',...
    pr.cyl.CO2.MC53{5}, V_cr.cyl.CO2.MC53{5}*1e-3, 'o-',...
    pr.cyl.CO2.MC53{6}, V_cr.cyl.CO2.MC53{6}*1e-3, 'o-')
%xlim([0 20])
ylim([0 400])
xlabel('pR (cm.Torr)')
ylabel('V (kV)')
title('Fig 7.18 - Co-ax')
set(gca,...
    'TickDir'   ,'out',...
    'XMinorTick','on' ,...
    'YMinorTick','on' ,...
    'YTick',0:50:1400);
legend(...
    [num2str(R7_18(1,1)*10,'%4.3f'),':',num2str(R7_18(1,2)*10,'%4.1f'),' mm'],...
    [num2str(R7_18(2,1)*10,'%4.2f'),':',num2str(R7_18(2,2)*10,'%4.1f'),' mm'],...
    [num2str(R7_18(3,1)*10,'%4.2f'),':',num2str(R7_18(3,2)*10,'%4.1f'),' mm'],...
    [num2str(R7_18(4,1)*10,'%4.2f'),':',num2str(R7_18(4,2)*10,'%4.1f'),' mm'],...
    'location','best')
legend boxoff

%% 
figure(3);
loglog(...
    pr.Crt.CO2.MC53{1}, V_cr.Crt.CO2.MC53{1}*1e-3, 'k+' ,...
    pr.cyl.CO2.MC53{1}, V_cr.cyl.CO2.MC53{1}*1e-3, 'bo-',...
    pr.cyl.CO2.MC53{2}, V_cr.cyl.CO2.MC53{2}*1e-3, 'r+-',...
    pr.Crt.CO2.MC53{2}, V_cr.Crt.CO2.MC53{2}*1e-3, 'ko-',...
    pr.Crt.CO2.MC53{3}, V_cr.Crt.CO2.MC53{3}*1e-3, 'ko-',...
    pr.Crt.CO2.MC53{4}, V_cr.Crt.CO2.MC53{4}*1e-3, 'ko-',...
    pr.Crt.CO2.MC53{5}, V_cr.Crt.CO2.MC53{5}*1e-3, 'ko-',...
    pr.Crt.CO2.MC53{6}, V_cr.Crt.CO2.MC53{6}*1e-3, 'ko-',...
    pr.Crt.CO2.MC53{7}, V_cr.Crt.CO2.MC53{7}*1e-3, 'ko-',...
    pr.Crt.CO2.MC53{8}, V_cr.Crt.CO2.MC53{8}*1e-3, 'ko-',...
    pr.Crt.CO2.MC53{9}, V_cr.Crt.CO2.MC53{9}*1e-3, 'ko-',...
    pr.cyl.CO2.MC53{3}, V_cr.cyl.CO2.MC53{3}*1e-3, 'go-',...
    pr.cyl.CO2.MC53{4}, V_cr.cyl.CO2.MC53{4}*1e-3, 'go-',...
    pr.cyl.CO2.MC53{5}, V_cr.cyl.CO2.MC53{5}*1e-3, 'go-',...
    pr.cyl.CO2.MC53{6}, V_cr.cyl.CO2.MC53{6}*1e-3, 'go-')
legend('Fig 2.17 Crt','Fig 2.24 cyl-','Fig 2.24 cyl+',...
    'Fig 7.5b Crt 01', 'Fig 7.5b Crt 02', 'Fig 7.5b Crt 03', 'Fig 7.5b Crt 04', 'Fig 7.5b Crt 05',...
    'Fig 7.5b Crt 07', 'Fig 7.5b Crt 10', 'Fig 7.5b Crt 20',...
    ['Fig 7.18 cyl ',num2str(R7_18(1,1)),':',num2str(R7_18(1,2))],...
    ['Fig 7.18 cyl ',num2str(R7_18(2,1)),':',num2str(R7_18(2,2))],...
    ['Fig 7.18 cyl ',num2str(R7_18(3,1)),':',num2str(R7_18(3,2))],...
    ['Fig 7.18 cyl ',num2str(R7_18(4,1)),':',num2str(R7_18(4,2))],...
    'location','best')
legend boxoff

xlabel('pd (cm.Torr)')
ylabel('V (kV)')

clearvars -except pr V_cr
save('Meek1953_sorted.mat')